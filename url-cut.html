<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>URL 단축기 - Fassto Marketing</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
    
    body {
      font-family: 'Pretendard', sans-serif;
    }
    
    .copy-feedback {
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s, visibility 0.3s;
    }
    
    .copy-feedback.show {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
  
<body class="bg-gray-50 flex flex-col min-h-screen">

  <nav class="bg-gray-100 border-b border-gray-300 mb-6">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="text-lg font-semibold text-green-700">Fassto</div>
      <button id="menu-toggle" class="block md:hidden text-gray-700 focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
      <ul id="menu" class="hidden md:flex flex-col md:flex-row md:items-center md:space-x-6 space-y-2 md:space-y-0 mt-4 md:mt-0 w-full md:w-auto">
        <li><a href="index.html" class="block text-gray-700 hover:text-green-600 font-medium px-3 py-2 rounded-md transition">홈</a></li>
        <li><a href="notice-tool.html" class="block text-gray-700 hover:text-green-600 font-medium px-3 py-2 rounded-md transition">공지 이미지 생성기</a></li>
        <li><a href="coordinate-finder.html" class="block text-gray-700 hover:text-green-600 font-medium px-3 py-2 rounded-md transition">좌표 찾기 도구</a></li>
        <li><a href="url-cut.html" class="block text-gray-700 hover:text-green-600 font-medium px-3 py-2 rounded-md transition">URL 단축기</a></li>
      </ul>
    </div>
  </nav>

  <main class="flex-grow container mx-auto p-4 max-w-2xl">
    <div class="bg-white p-8 rounded-lg shadow-lg">
      <h1 class="text-3xl font-bold mb-4 text-center">URL 단축기</h1>
      <div class="mb-6">
        <label class="block mb-2 text-gray-700 font-medium">URL 입력</label>
        <div class="flex">
          <input id="url-input" type="url" placeholder="https://example.com" class="flex-grow px-4 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-green-500">
          <button id="shorten-btn" class="px-4 py-2 bg-green-600 text-white font-medium rounded-r-lg hover:bg-green-700">단축</button>
        </div>
      </div>
      <div id="result-container" class="hidden mt-6">
        <label class="block mb-2 text-gray-700 font-medium">생성된 단축 URL</label>
        <div class="flex items-center space-x-3">
          <a id="short-url" href="#" target="_blank" class="text-green-600 break-all"></a>
          <button id="copy-btn" class="px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300">복사</button>
          <span id="copy-feedback" class="copy-feedback text-sm text-green-600">복사 완료!</span>
        </div>
      </div>
    </div>
  </main>

  <footer class="bg-gray-200 text-center p-4 mt-auto">
    <p class="text-sm text-gray-600">© 2025 Fassto Marketing. All Rights Reserved.</p>
  </footer>
  
  <script>
    const urlInput = document.getElementById('url-input');
    const shortenBtn = document.getElementById('shorten-btn');
    const resultContainer = document.getElementById('result-container');
    const shortUrlElement = document.getElementById('short-url');
    const copyBtn = document.getElementById('copy-btn');
    const copyFeedback = document.getElementById('copy-feedback');

    async function shortenUrl() {
      const originalUrl = urlInput.value.trim();
      if (!originalUrl || !/^https?:\/\//.test(originalUrl)) {
        alert("유효한 URL을 입력해주세요.");
        return;
      }

      const res = await fetch('/.netlify/functions/shorten', {
        method: 'POST',
        body: JSON.stringify({ originalUrl })
      });

      if (!res.ok) {
        alert("단축에 실패했습니다.");
        return;
      }

      const data = await res.json();
      const shortUrl = `${window.location.origin}/r/${data.shortCode}`;

      shortUrlElement.textContent = shortUrl;
      shortUrlElement.href = shortUrl;
      resultContainer.classList.remove('hidden');
    }

    function copyToClipboard() {
      navigator.clipboard.writeText(shortUrlElement.textContent).then(() => {
        copyFeedback.classList.add('show');
        setTimeout(() => copyFeedback.classList.remove('show'), 2000);
      });
    }

    shortenBtn.addEventListener('click', shortenUrl);
    copyBtn.addEventListener('click', copyToClipboard);
    urlInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') shortenUrl();
    });
  </script>

  <script>
    document.getElementById('menu-toggle').addEventListener('click', function () {
      const menu = document.getElementById('menu');
      menu.classList.toggle('hidden');
    });
  </script>
  
</body>
</html>
